<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>DarlanBets - Apostas Inteligentes</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #1a1f3a;
            min-height: 100vh;
            padding: 20px;
            color: #fff;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        /* === HEADER === */
        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.1);
        }

        h1 {
            font-size: 3em;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            color: #ffffff;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
            animation: glow 3s infinite;
        }

        @keyframes glow {
            0%, 100% { text-shadow: 0 0 20px rgba(255, 255, 255, 0.3); }
            50% { text-shadow: 0 0 30px rgba(255, 255, 255, 0.5); }
        }

        .subtitle {
            font-size: 1.2em;
            color: #ffffff;
            margin-bottom: 15px;
            opacity: 0.9;
        }

        .info-badge {
            display: inline-flex;
            align-items: center;
            gap: 20px;
            background: rgba(255, 255, 255, 0.1);
            padding: 12px 30px;
            border-radius: 25px;
            margin-top: 10px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .info-badge span {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #ffffff;
        }

        /* === TABS === */
        .tabs {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 40px;
            flex-wrap: wrap;
        }

        .tab {
            padding: 15px 35px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            color: #ffffff;
            cursor: pointer;
            border-radius: 30px;
            font-size: 17px;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tab:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.2);
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(255, 255, 255, 0.2);
        }

        .tab.active {
            background: #ffffff;
            color: #1a1f3a;
            border-color: #ffffff;
            box-shadow: 0 5px 20px rgba(255, 255, 255, 0.3);
        }

        /* === SECTIONS === */
        .section {
            display: none;
        }

        .section.active {
            display: block;
        }

        .embed-container {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 25px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .embed-title {
            color: #ffffff;
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 20px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }

        iframe {
            border-radius: 15px;
            border: none;
            background: rgba(0, 0, 0, 0.3);
        }

        /* === CHAT FLUTUANTE === */
        .floating-chat-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 70px;
            height: 70px;
            background: linear-gradient(135deg, #42a5f5, #1e88e5);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 8px 30px rgba(66, 165, 245, 0.6);
            z-index: 1000;
            transition: all 0.3s;
            border: none;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% {
                box-shadow: 0 8px 30px rgba(66, 165, 245, 0.6);
                transform: scale(1);
            }
            50% {
                box-shadow: 0 8px 40px rgba(66, 165, 245, 0.8);
                transform: scale(1.05);
            }
        }

        .floating-chat-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 10px 40px rgba(66, 165, 245, 0.8);
        }

        .floating-chat-btn i {
            font-size: 32px;
            color: white;
        }

        .chat-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #ff4444;
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
            border: 2px solid #1a1f3a;
            animation: bounce 1s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        /* === JANELA DO CHAT === */
        .floating-chat-window {
            position: fixed;
            bottom: 120px;
            right: 30px;
            width: 400px;
            height: 600px;
            background: rgba(26, 31, 58, 0.98);
            border-radius: 20px;
            box-shadow: 0 10px 50px rgba(0, 0, 0, 0.5);
            z-index: 999;
            display: none;
            flex-direction: column;
            border: 2px solid rgba(66, 165, 245, 0.3);
            overflow: hidden;
            animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .floating-chat-window.open {
            display: flex;
        }

        .chat-window-header {
            background: linear-gradient(135deg, #42a5f5, #1e88e5);
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }

        .chat-window-title {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .chat-window-title i {
            font-size: 24px;
        }

        .chat-window-title div h3 {
            font-size: 1.2em;
            margin-bottom: 2px;
        }

        .chat-window-title div p {
            font-size: 0.85em;
            opacity: 0.9;
        }

        .chat-close-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .chat-close-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(90deg);
        }

        .chat-window-body {
            flex: 1;
            overflow: hidden;
            background: #0f2027;
        }

        .chat-iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        /* === RESPONSIVE === */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            h1 {
                font-size: 1.8em;
                flex-direction: column;
                gap: 10px;
            }

            .subtitle {
                font-size: 1em;
            }

            .info-badge {
                flex-direction: column;
                gap: 10px;
                padding: 10px 20px;
            }

            .info-badge span {
                font-size: 0.9em;
            }

            header {
                padding: 20px 15px;
                margin-bottom: 20px;
            }

            .tabs {
                gap: 10px;
                margin-bottom: 20px;
            }

            .tab {
                padding: 12px 20px;
                font-size: 15px;
                flex: 1;
                min-width: 140px;
                justify-content: center;
            }

            .tab i {
                font-size: 14px;
            }

            .embed-container {
                padding: 15px;
                border-radius: 15px;
            }

            .embed-title {
                font-size: 1.2em;
                margin-bottom: 15px;
                flex-direction: column;
                gap: 8px;
            }

            .embed-title i {
                font-size: 1.2em;
            }

            #live iframe,
            #schedule iframe {
                height: 600px !important;
                border-radius: 10px;
            }

            /* Chat Flutuante Mobile */
            .floating-chat-btn {
                width: 60px;
                height: 60px;
                bottom: 20px;
                right: 20px;
            }

            .floating-chat-btn i {
                font-size: 28px;
            }

            .floating-chat-window {
                bottom: 0;
                right: 0;
                left: 0;
                width: 100%;
                height: 100vh;
                border-radius: 0;
                max-height: 100vh;
            }

            .chat-window-header {
                padding: 15px;
            }

            .chat-window-title div h3 {
                font-size: 1.1em;
            }

            .chat-window-title div p {
                font-size: 0.8em;
            }

            .chat-window-title i {
                font-size: 20px;
            }
        }

        @media (max-width: 480px) {
            h1 {
                font-size: 1.5em;
            }

            .tab {
                font-size: 14px;
                padding: 10px 15px;
                min-width: 120px;
            }

            .floating-chat-btn {
                width: 55px;
                height: 55px;
            }

            .floating-chat-btn i {
                font-size: 24px;
            }

            .chat-badge {
                width: 20px;
                height: 20px;
                font-size: 11px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- HEADER -->
        <header>
            <h1>
                <i class="fas fa-dice"></i>
                DarlanBets
            </h1>
            <p class="subtitle">Apostas Inteligentes com Inteligência Artificial</p>
            <div class="info-badge">
                <span><i class="fas fa-brain"></i> IA Avançada</span>
                <span><i class="fas fa-chart-line"></i> Análises em Tempo Real</span>
                <span><i class="fas fa-trophy"></i> Palpites Certeiros</span>
            </div>
        </header>

        <!-- ABAS -->
        <div class="tabs">
            <button class="tab" onclick="showSection('live')">
                <i class="fas fa-circle" style="color: #ff4444;"></i>
                Ao Vivo Agora
            </button>
            <button class="tab active" onclick="showSection('schedule')">
                <i class="fas fa-calendar-alt"></i>
                Programação
            </button>
        </div>

        <!-- JOGOS AO VIVO -->
        <div id="live" class="section">
            <div class="embed-container">
                <div class="embed-title">
                    <i class="fas fa-futbol"></i>
                    Placar ao Vivo - Jogos Acontecendo Agora
                </div>
                <iframe 
                    src="https://www.scorebat.com/embed/livescore/?token=MjQ2MDczXzE3NjEwNDY2MDRfODRiM2ZlZTY4NGM3YjJiYzVlOGE1MjNjZjgwODM1ZDQyZmIwOGRlMw==" 
                    width="100%" 
                    height="760" 
                    allowfullscreen 
                    allow='autoplay; fullscreen'>
                </iframe>
            </div>
        </div>

        <!-- PROGRAMAÇÃO -->
        <div id="schedule" class="section active">
            <div class="embed-container">
                <div class="embed-title">
                    <i class="fas fa-list-alt"></i>
                    Jogos da Semana - Horários e Resultados
                </div>
                <iframe 
                    src="https://www.scorebat.com/embed/livescore/" 
                    width="100%" 
                    height="800" 
                    allowfullscreen>
                </iframe>
            </div>
        </div>
    </div>

    <!-- BOTÃO FLUTUANTE DO CHAT -->
    <button class="floating-chat-btn" onclick="toggleChat()" id="chatBtn">
        <i class="fas fa-comments"></i>
        <span class="chat-badge">!</span>
    </button>

    <!-- JANELA DO CHAT FLUTUANTE -->
    <div class="floating-chat-window" id="chatWindow">
        <div class="chat-window-header">
            <div class="chat-window-title">
                <i class="fas fa-robot"></i>
                <div>
                    <h3>Assistente IA</h3>
                    <p>Online - Palpites em tempo real</p>
                </div>
            </div>
            <button class="chat-close-btn" onclick="toggleChat()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="chat-window-body">
            <iframe 
                id="chatIframe"
                class="chat-iframe"
                src=""
                allow="clipboard-write; microphone">
            </iframe>
        </div>
    </div>

    <script>
        // Variáveis globais
        let userIPAddress = null;
        let sessionId = null;
        let chatInitialized = false;

        // Função para obter IP do usuário
        async function getUserIP() {
            try {
                console.log('🌐 Buscando IP do usuário...');
                
                const apis = [
                    'https://api.ipify.org?format=json',
                    'https://api64.ipify.org?format=json',
                    'https://ipapi.co/json/'
                ];

                for (const api of apis) {
                    try {
                        const response = await fetch(api);
                        const data = await response.json();
                        
                        if (data.ip) {
                            userIPAddress = data.ip;
                            console.log('✅ IP encontrado:', userIPAddress);
                            return userIPAddress;
                        }
                    } catch (err) {
                        continue;
                    }
                }
                
                userIPAddress = 'IP_' + Date.now();
                return userIPAddress;
                
            } catch (error) {
                console.error('❌ Erro ao obter IP:', error);
                userIPAddress = 'IP_' + Date.now();
                return userIPAddress;
            }
        }

        // Função para gerar Session ID
        function generateSessionId() {
            const timestamp = Date.now();
            const random = Math.random().toString(36).substring(2, 11);
            const ip = userIPAddress || 'noip';
            
            sessionId = `${ip}_${timestamp}_${random}`;
            console.log('🔑 Session ID:', sessionId);
            return sessionId;
        }

        // Função para inicializar o chat
        async function initializeChat() {
            if (chatInitialized) return;
            
            try {
                console.log('🚀 Inicializando chat...');
                
                // Obter IP
                await getUserIP();
                
                // Gerar sessionId
                const finalSessionId = generateSessionId();
                
                // Configurar iframe
                const chatIframe = document.getElementById('chatIframe');
                const iframeUrl = `https://n8n-n8n.rthuab.easypanel.host/webhook/9f33aea9-a9bd-4275-a0cc-35c7d295c42c/chat?sessionId=${encodeURIComponent(finalSessionId)}&userIP=${encodeURIComponent(userIPAddress)}`;
                
                chatIframe.src = iframeUrl;
                chatInitialized = true;
                
                // Remover badge de notificação
                const badge = document.querySelector('.chat-badge');
                if (badge) badge.style.display = 'none';
                
                console.log('✅ Chat inicializado com sucesso');
                
            } catch (error) {
                console.error('❌ Erro ao inicializar chat:', error);
            }
        }

        // Função para abrir/fechar chat
        function toggleChat() {
            const chatWindow = document.getElementById('chatWindow');
            chatWindow.classList.toggle('open');
            
            // Inicializar chat na primeira abertura
            if (chatWindow.classList.contains('open') && !chatInitialized) {
                initializeChat();
            }
        }

        // Função para alternar seções
        function showSection(sectionId) {
            const sections = document.querySelectorAll('.section');
            const tabs = document.querySelectorAll('.tab');
            
            sections.forEach(section => section.classList.remove('active'));
            tabs.forEach(tab => tab.classList.remove('active'));
            
            document.getElementById(sectionId).classList.add('active');
            event.target.classList.add('active');
        }

        // Carregar script do ScoreBat
        (function(d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) return;
            js = d.createElement(s); 
            js.id = id;
            js.src = 'https://www.scorebat.com/embed/embed.js?v=arrv';
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'scorebat-jssdk'));

        // Pré-carregar IP em background
        getUserIP();

        console.log('✅ DarlanBets - Sistema carregado');
        console.log('💬 Chat flutuante pronto para uso');
    </script>
</body>
</html>
